/* [create-plugin] version: 5.2.2 */
define(["@emotion/css","@grafana/data","@grafana/runtime","@grafana/ui","module","react","react-router-dom","rxjs"],((e,t,r,a,o,n,i,l)=>(()=>{"use strict";var s={89:t=>{t.exports=e},781:e=>{e.exports=t},531:e=>{e.exports=r},7:e=>{e.exports=a},308:e=>{e.exports=o},959:e=>{e.exports=n},806:e=>{e.exports=i},269:e=>{e.exports=l}},d={};function c(e){var t=d[e];if(void 0!==t)return t.exports;var r=d[e]={exports:{}};return s[e](r,r.exports,c),r.exports}c.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return c.d(t,{a:t}),t},c.d=(e,t)=>{for(var r in t)c.o(t,r)&&!c.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.p="public/plugins/mahendrapaipuri-dashboardreporter-app/";var p={};c.r(p),c.d(p,{plugin:()=>ue});var m=c(308),u=c.n(m);c.p=u()&&u().uri?u().uri.slice(0,u().uri.lastIndexOf("/")+1):"public/plugins/mahendrapaipuri-dashboardreporter-app/";var h=c(781),g=c(959),f=c.n(g);const b=f().createContext(null);var v=c(806),k=c(531);const T={appUrl:"data-testid ac-url",skipTlsCheck:"data-testid ac-skip-tls-check",saToken:"data-testid ac-sa-token",container:"data-testid ac-container",theme:"data-testid ac-theme",layout:"data-testid ac-layout",orientation:"data-testid ac-orientation",dashboardMode:"data-testid ac-dashboard-mode",tz:"data-testid ac-timezone",logo:"data-testid ac-logo",headerTemplate:"data-testid ac-header-template",footerTemplate:"data-testid ac-footer-template",maxBrowserWorkers:"data-testid ac-max-browser-workers",maxRenderWorkers:"data-testid ac-max-render-workers",remoteChromeUrl:"data-testid ac-remote-chrome-url",submit:"data-testid ac-submit-form"},y={container:"data-testid pg-one-container",health:"data-testid pg-one-health",config:"data-testid pg-one-config"};var C=function(){return C=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},C.apply(this,arguments)};Object.create;Object.create;"function"==typeof SuppressedError&&SuppressedError;function E(e,t,r){void 0===t&&(t=[]),void 0===r&&(r={loading:!1});var a,o,n=(0,g.useRef)(0),i=(a=(0,g.useRef)(!1),o=(0,g.useCallback)((function(){return a.current}),[]),(0,g.useEffect)((function(){return a.current=!0,function(){a.current=!1}}),[]),o),l=(0,g.useState)(r),s=l[0],d=l[1],c=(0,g.useCallback)((function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var a=++n.current;return s.loading||d((function(e){return C(C({},e),{loading:!0})})),e.apply(void 0,t).then((function(e){return i()&&a===n.current&&d({value:e,loading:!1}),e}),(function(e){return i()&&a===n.current&&d({error:e,loading:!1}),e}))}),t);return[s,c]}var x=c(7);const w=`${JSON.parse('{"id":"mahendrapaipuri-dashboardreporter-app"}').id}`,O=`/a/${w}`;var S=function(e){return e.Status="status",e.Config="config",e}({});const P={status:{id:"status",text:"Status",icon:"heart",url:`${O}/status`},config:{id:"config",text:"Configuration",icon:"cog",url:`plugins/${w}`}},j=()=>{const{error:e,loading:t,value:r}=function(e,t){void 0===t&&(t=[]);var r=E(e,t,{loading:!0}),a=r[0],o=r[1];return(0,g.useEffect)((function(){o()}),[o]),a}((()=>{const e=(0,k.getBackendSrv)();return Promise.all([e.get("api/plugins/mahendrapaipuri-dashboardreporter-app/health")])}));if(t)return g.createElement("div",{"data-testid":y.container},g.createElement("span",null,"Loading..."));if(e||!r)return g.createElement("div",{"data-testid":y.container},g.createElement("span",null,"Error: ",null==e?void 0:e.message));const[a]=r;return g.createElement(k.PluginPage,{layout:h.PageLayoutType.Canvas},g.createElement("div",{"data-testid":y.container},g.createElement(x.Stack,null,g.createElement("h3",null,"Plugin Health Check")," ",g.createElement("span",{"data-testid":y.health},function(e){if("ok"===e)return g.createElement(x.Badge,{color:"green",text:"OK",icon:"heart"});return g.createElement(x.Badge,{color:"red",text:"BAD",icon:"bug"})}(null==a?void 0:a.message))),g.createElement("div",{style:{marginBottom:"25px"}},"Only users with Admin role can modify the configuration of the plugin"),g.createElement("div",{"data-testid":y.config},g.createElement(x.LinkButton,{icon:"cog",href:P[S.Config].url},"Configuration"))))};const B=()=>g.createElement(v.Switch,null,g.createElement(v.Route,{component:j}));class W extends g.PureComponent{render(){return g.createElement(b.Provider,{value:this.props},g.createElement(B,null))}}var R=c(269),U=c(89),N=Object.defineProperty,M=Object.defineProperties,D=Object.getOwnPropertyDescriptors,F=Object.getOwnPropertySymbols,I=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable,Z=(e,t,r)=>t in e?N(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$=(e,t)=>{for(var r in t||(t={}))I.call(t,r)&&Z(e,r,t[r]);if(F)for(var r of F(t))A.call(t,r)&&Z(e,r,t[r]);return e};const L=({children:e,title:t,description:r,isCollapsible:a=!1,isInitiallyOpen:o=!0,kind:n="section",className:i})=>{const{colors:l,typography:s,spacing:d}=(0,x.useTheme2)(),[c,p]=(0,g.useState)(!a||o),m=c?"angle-up":"angle-down",u="sub-section"===n,h=`${c?"Collapse":"Expand"} section ${t}`,b={header:(0,U.css)({display:"flex",justifyContent:"space-between",alignItems:"center"}),title:(0,U.css)({margin:0}),subtitle:(0,U.css)({margin:0,fontWeight:s.fontWeightRegular}),descriptionText:(0,U.css)((v=$({marginTop:d(u?.25:.5),marginBottom:0},s.bodySmall),k={color:l.text.secondary},M(v,D(k)))),content:(0,U.css)({marginTop:d(2)})};var v,k;return f().createElement("div",{className:i},f().createElement("div",{className:b.header},"section"===n?f().createElement("h3",{className:b.title},t):f().createElement("h6",{className:b.subtitle},t),a&&f().createElement(x.IconButton,{name:m,onClick:()=>p(!c),type:"button",size:"xl","aria-label":h})),r&&f().createElement("p",{className:b.descriptionText},r),c&&f().createElement("div",{className:b.content},e))};var G=Object.defineProperty,z=Object.defineProperties,H=Object.getOwnPropertyDescriptors,J=Object.getOwnPropertySymbols,_=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable,q=(e,t,r)=>t in e?G(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const K=e=>{var t,r=e,{children:a}=r,o=((e,t)=>{var r={};for(var a in e)_.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&J)for(var a of J(e))t.indexOf(a)<0&&V.call(e,a)&&(r[a]=e[a]);return r})(r,["children"]);return f().createElement(L,(t=((e,t)=>{for(var r in t||(t={}))_.call(t,r)&&q(e,r,t[r]);if(J)for(var r of J(t))V.call(t,r)&&q(e,r,t[r]);return e})({},o),z(t,H({kind:"section"}))),a)};var X=Object.defineProperty,Y=Object.defineProperties,Q=Object.getOwnPropertyDescriptors,ee=Object.getOwnPropertySymbols,te=Object.prototype.hasOwnProperty,re=Object.prototype.propertyIsEnumerable,ae=(e,t,r)=>t in e?X(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const oe=e=>{var t,r=e,{children:a}=r,o=((e,t)=>{var r={};for(var a in e)te.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&ee)for(var a of ee(e))t.indexOf(a)<0&&re.call(e,a)&&(r[a]=e[a]);return r})(r,["children"]);return f().createElement(L,(t=((e,t)=>{for(var r in t||(t={}))te.call(t,r)&&ae(e,r,t[r]);if(ee)for(var r of ee(t))re.call(t,r)&&ae(e,r,t[r]);return e})({},o),Y(t,Q({kind:"sub-section"}))),a)};function ne(e,t,r,a,o,n,i){try{var l=e[n](i),s=l.value}catch(e){return void r(e)}l.done?t(s):Promise.resolve(s).then(a,o)}function ie(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var n=e.apply(t,r);function i(e){ne(n,a,o,i,l,"next",e)}function l(e){ne(n,a,o,i,l,"throw",e)}i(void 0)}))}}function le(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},a=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),a.forEach((function(t){le(e,t,r[t])}))}return e}function de(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const ce=e=>({colorWeak:(0,U.css)({color:`${e.colors.text.secondary}`}),marginTop:(0,U.css)({marginTop:`${e.spacing(3)}`}),marginTopXl:(0,U.css)({marginTop:`${e.spacing(6)}`}),hrBottomSpace:(0,U.css)({marginBottom:"56px"}),hrTopSpace:(0,U.css)({marginTop:"50px"}),reportSettings:(0,U.css)({paddingTop:"32px"}),textarea:(0,U.css)({width:"620px"})}),pe=function(){var e=ie((function*(e,t){try{yield me(e,t),window.location.reload()}catch(e){console.error("Error while updating the plugin",e)}}));return function(t,r){return e.apply(this,arguments)}}(),me=function(){var e=ie((function*(e,t){const r=yield(0,k.getBackendSrv)().fetch({url:`/api/plugins/${e}/settings`,method:"POST",data:t});return(0,R.lastValueFrom)(r)}));return function(t,r){return e.apply(this,arguments)}}(),ue=(new h.AppPlugin).setRootPage(W).addConfigPage({title:"Configuration",icon:"cog",body:({plugin:e})=>{const t=(0,x.useStyles2)(ce),{enabled:r,pinned:a,jsonData:o,secureJsonFields:n}=e.meta,[i,l]=(0,g.useState)({appUrl:(null==o?void 0:o.appUrl)||"",appUrlChanged:!1,skipTlsCheck:(null==o?void 0:o.skipTlsCheck)||!1,skipTlsCheckChanged:!1,theme:(null==o?void 0:o.theme)||"light",themeChanged:!1,orientation:(null==o?void 0:o.orientation)||"portrait",orientationChanged:!1,layout:(null==o?void 0:o.layout)||"simple",layoutChanged:!1,dashboardMode:(null==o?void 0:o.dashboardMode)||"default",dashboardModeChanged:!1,timeZone:(null==o?void 0:o.timeZone)||"",timeZoneChanged:!1,logo:(null==o?void 0:o.logo)||"",logoChanged:!1,headerTemplate:(null==o?void 0:o.headerTemplate)||"",headerTemplateChanged:!1,footerTemplate:(null==o?void 0:o.footerTemplate)||"",footerTemplateChanged:!1,maxBrowserWorkers:(null==o?void 0:o.maxBrowserWorkers)||2,maxBrowserWorkersChanged:!1,maxRenderWorkers:(null==o?void 0:o.maxRenderWorkers)||2,maxRenderWorkersChanged:!1,remoteChromeUrl:(null==o?void 0:o.remoteChromeUrl)||"",remoteChromeUrlChanged:!1,saToken:"",isSaTokenSet:Boolean(null==n?void 0:n.saToken),isSaTokenReset:!1});return f().createElement("div",{"data-testid":T.container},f().createElement(x.FieldSet,{label:"Enable / Disable"},!r&&f().createElement(f().Fragment,null,f().createElement("div",{className:t.colorWeak},"The plugin is currently not enabled."),f().createElement(x.Button,{className:t.marginTop,variant:"primary",onClick:()=>pe(e.meta.id,{enabled:!0,pinned:!0,jsonData:{appUrl:i.appUrl,skipTlsCheck:i.skipTlsCheck,theme:i.theme,orientation:i.orientation,layout:i.layout,dashboardMode:i.dashboardMode,timeZone:i.timeZone,logo:i.logo,headerTemplate:i.headerTemplate,footerTemplate:i.footerTemplate,maxBrowserWorkers:i.maxBrowserWorkers,maxRenderWorkers:i.maxRenderWorkers,remoteChromeUrl:i.remoteChromeUrl},secureJsonData:i.isSaTokenSet?void 0:{saToken:i.saToken}})},"Enable plugin")),r&&f().createElement(f().Fragment,null,f().createElement("div",{className:t.colorWeak},"The plugin is currently enabled."),f().createElement(x.Button,{className:t.marginTop,variant:"destructive",onClick:()=>pe(e.meta.id,{enabled:!1,pinned:!1,jsonData:{appUrl:i.appUrl,skipTlsCheck:i.skipTlsCheck,theme:i.theme,orientation:i.orientation,layout:i.layout,dashboardMode:i.dashboardMode,timeZone:i.timeZone,logo:i.logo,headerTemplate:i.headerTemplate,footerTemplate:i.footerTemplate,maxBrowserWorkers:i.maxBrowserWorkers,maxRenderWorkers:i.maxRenderWorkers,remoteChromeUrl:i.remoteChromeUrl},secureJsonData:i.isSaTokenSet?void 0:{saToken:i.saToken}})},"Disable plugin"))),f().createElement("hr",{className:`${t.hrTopSpace} ${t.hrBottomSpace}`}),f().createElement(K,{title:"Authentication",description:"Use this section to configure service account tokens when Grafana < 10.3.0 is used or externalServiceAccounts feature is not enabled"},f().createElement(x.Field,{label:"Service Account Token",description:"This token will be used to make API requests to Grafana for generating reports.","data-testid":T.saToken},f().createElement(x.SecretInput,{width:60,id:"sa-token",value:i.saToken,isConfigured:i.isSaTokenSet,placeholder:i.isSaTokenSet?"configured":"Your service account token here",onChange:e=>{l(de(se({},i),{saToken:e.target.value.trim()}))},onReset:()=>l(de(se({},i),{saToken:"",isSaTokenSet:!1,isSaTokenReset:!0}))}))),f().createElement("hr",{className:`${t.hrTopSpace} ${t.hrBottomSpace}`}),f().createElement(K,{title:"Report Settings",description:"Use this section to customise the generated report"},f().createElement(x.Field,{label:"Theme",description:"Panels theme to be used in the report.","data-testid":T.theme,className:t.marginTop},f().createElement(x.RadioButtonGroup,{options:[{label:"Light",value:"light"},{label:"Dark",value:"dark"}],value:i.theme,onChange:e=>{l(de(se({},i),{theme:e,themeChanged:!0}))}})),f().createElement(x.Field,{label:"Layout",description:"Display the panels in their positions on the dashboard.","data-testid":T.layout,className:t.marginTop},f().createElement(x.RadioButtonGroup,{options:[{label:"Simple",value:"simple",icon:"gf-layout-simple"},{label:"Grid",value:"grid",icon:"gf-grid"}],value:i.layout,onChange:e=>{l(de(se({},i),{layout:e,layoutChanged:!0}))}})),f().createElement(x.Field,{label:"Report Orientation",description:"Orientation of the report.","data-testid":T.orientation,className:t.marginTop},f().createElement(x.RadioButtonGroup,{options:[{label:"Portrait",value:"portrait",icon:"gf-portrait"},{label:"Landscape",value:"landscape",icon:"gf-landscape"}],value:i.orientation,onChange:e=>{l(de(se({},i),{orientation:e,orientationChanged:!0}))}})),f().createElement(x.Field,{label:"Dashboard Mode",description:"Whether to render full dashboard by uncollapsing panels in all rows or to render default dashboard without panels in collapsed rows.","data-testid":T.dashboardMode,className:t.marginTop},f().createElement(x.RadioButtonGroup,{options:[{label:"Default",value:"default"},{label:"Full",value:"full"}],value:i.dashboardMode,onChange:e=>{l(de(se({},i),{dashboardMode:e,dashboardModeChanged:!0}))}})),f().createElement(x.Field,{label:"Time Zone",description:"Time Zone in IANA format. By default time zone of the server will be used.","data-testid":T.tz,className:t.marginTop},f().createElement(x.Input,{type:"string",width:60,id:"tz",label:"Time Zone",value:i.timeZone,onChange:e=>{l(de(se({},i),{timeZone:e.target.value,timeZoneChanged:!0}))}})),f().createElement(x.Field,{label:"Branding Logo",description:"Base 64 encoded logo to include in the report.","data-testid":T.logo,className:t.marginTop},f().createElement(x.Input,{type:"string",width:60,id:"logo",label:"Logo",value:i.logo,onChange:e=>{l(de(se({},i),{logo:e.target.value,logoChanged:!0}))}})),f().createElement(oe,{title:"Advanced Settings",description:"Use this section to customize the reports",isCollapsible:!0,isInitiallyOpen:!1},f().createElement(x.Field,{label:"Report Header Template",description:"HTML template used in the header of the report.","data-testid":T.headerTemplate},f().createElement(x.TextArea,{id:"headerTemplate",rows:20,className:t.textarea,label:"Header Template",onChange:e=>{l(de(se({},i),{headerTemplate:e.target.value,headerTemplateChanged:!0}))}},i.headerTemplate)),f().createElement(x.Field,{label:"Report Footer Template",description:"HTML template used in the footer of the report.","data-testid":T.footerTemplate},f().createElement(x.TextArea,{id:"footerTemplate",rows:20,className:t.textarea,label:"Footer Template",onChange:e=>{l(de(se({},i),{footerTemplate:e.target.value,footerTemplateChanged:!0}))}},i.footerTemplate)))),f().createElement("hr",{className:`${t.hrTopSpace} ${t.hrBottomSpace}`}),f().createElement(K,{title:"Additional Settings",description:"Additional settings are optional settings that can be configured for more control over the plugin app.",isCollapsible:!0,isInitiallyOpen:!1},f().createElement(x.Field,{label:"Grafana Hostname",description:"Overrides the automatic grafana hostname detection. Use this if you have a reverse proxy in front of Grafana.","data-testid":T.appUrl,className:t.marginTop},f().createElement(x.Input,{type:"url",width:60,id:"appUrl",label:"Grafana Hostname",value:i.appUrl,onChange:e=>{l(de(se({},i),{appUrl:e.target.value,appUrlChanged:!0}))}})),f().createElement(x.Field,{label:"Skip TLS Verification",description:"Do not validate TLS certificates when connecting to Grafana. NOTE: If using an remote chrome instance, set --ignore-certificate-errors flag in chrome.","data-testid":T.skipTlsCheck,className:t.marginTop},f().createElement(x.Switch,{id:"skipTlsCheck",value:i.skipTlsCheck,onChange:e=>{l(de(se({},i),{skipTlsCheck:e.target.checked,skipTlsCheckChanged:!0}))}})),f().createElement(x.Field,{label:"Remote Chrome URL",description:"Address to a running chrome instance with an listening chrome remote debug socket","data-testid":T.remoteChromeUrl,className:t.marginTop},f().createElement(x.Input,{type:"url",width:60,id:"remoteChromeUrl",label:"Remote Chrome URL",value:i.remoteChromeUrl,onChange:e=>{l(de(se({},i),{remoteChromeUrl:e.target.value,remoteChromeUrlChanged:!0}))}})),f().createElement(x.Field,{label:"Maximum Browser Workers",description:"Maximum number of workers for interacting with chrome browser. Default is 2.",className:t.marginTop},f().createElement(x.Input,{type:"number",width:60,id:"max-browser-workers","data-testid":T.maxBrowserWorkers,label:"Maximum Browser Workers",pattern:"[0-9]{1,2}",value:i.maxBrowserWorkers,onChange:e=>{l(de(se({},i),{maxBrowserWorkers:e.target.valueAsNumber,maxBrowserWorkersChanged:!0}))}})),f().createElement(x.Field,{label:"Maximum Render Workers",description:"Maximum number of workers for rendering panels into PNGs. Default is 2.",className:t.marginTop},f().createElement(x.Input,{type:"number",width:60,id:"max-render-workers","data-testid":T.maxRenderWorkers,label:"Maximum Render Workers",pattern:"[0-9]{1,2}",value:i.maxRenderWorkers,onChange:e=>{l(de(se({},i),{maxRenderWorkers:e.target.valueAsNumber,maxRenderWorkersChanged:!0}))}}))),f().createElement("div",{className:t.marginTop},f().createElement(x.Button,{type:"submit","data-testid":T.submit,onClick:()=>pe(e.meta.id,{enabled:r,pinned:a,jsonData:{appUrl:i.appUrl,skipTlsCheck:i.skipTlsCheck,theme:i.theme,orientation:i.orientation,layout:i.layout,dashboardMode:i.dashboardMode,timeZone:i.timeZone,logo:i.logo,headerTemplate:i.headerTemplate,footerTemplate:i.footerTemplate,maxBrowserWorkers:i.maxBrowserWorkers,maxRenderWorkers:i.maxRenderWorkers,remoteChromeUrl:i.remoteChromeUrl},secureJsonData:i.isSaTokenSet?void 0:{saToken:i.saToken}}),disabled:Boolean(!(i.appUrlChanged||i.skipTlsCheckChanged||i.themeChanged||i.layoutChanged||i.orientationChanged||i.dashboardModeChanged||i.timeZoneChanged||i.logoChanged||i.headerTemplateChanged||i.footerTemplateChanged||i.maxBrowserWorkersChanged||i.maxRenderWorkersChanged||i.remoteChromeUrlChanged||i.isSaTokenReset||i.saToken))},"Save settings")))},id:"configuration"});return p})()));
//# sourceMappingURL=module.js.map